---
emoji: ğŸ”®
title: ì•”í˜¸í™” ê²‰í•¥ê¸°
date: '2019-12-01'
Tags: Cryptography Python
author: fleta
categories: Tech
---


ê·¼ë˜ ì–´ë–¤ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ìš”ì²­ì˜ ìœ íš¨ì„±ì„ íŒë‹¨í•  ìš©ë„ì¸ í‚¤ì˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ ì•”í˜¸í™”ë¥¼ ê³ ë¯¼í•˜ê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ ì ìš© ê³¼ì •ì—ì„œ ë‚˜ì™”ë˜ ì§ˆë¬¸ì— ëŒ€í•œ ë‚´ ë‚˜ë¦„ëŒ€ë¡œì˜ ì •ë¦¬ë¥¼ ë‚¨ê²¨ë³´ê³ ì í•œë‹¤.


## 1. ì•”í˜¸í™”? ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜?

ì•”í˜¸í™”ë¥¼ í•œë§ˆë””ë¡œ ì •ì˜í•˜ìë©´ "ìˆ˜í•™ì ì¸ ê³¼ì •ì„ í†µí•´ ì •ë³´ë¥¼ ê°€ì§„ ë¬¸ìì—´ì„ ì˜ë¯¸ ì—†ëŠ” ë¬¸ìì—´ë¡œ ë°”ê¾¸ëŠ” ê²ƒ" ì •ë„ë¼ê³  ìƒê°í•œë‹¤.

ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì„ ì„¤ê³„í•  ë•Œ confusionê³¼ diffusionì˜ ì„±ì§ˆì„ ì´ìš©í•œë‹¤. ì´ ì„±ì§ˆë“¤ì„ ì–»ê¸° ìœ„í•´ substituionê³¼ permutationì´ ì‚¬ìš©ë˜ë©°, ì´ë“¤ì„ ì ì ˆíˆ ì¡°í•©í•˜ì—¬ roundë¥¼ ë§Œë“¤ê³  êµ¬ì„±ëœ roundë“¤ì„ ë°˜ë³µí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”ê°€ ì´ë£¨ì–´ì§„ë‹¤. 

Confusionê³¼ diffusionì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ë©´..
- í†µê³„ ë° ì•”í˜¸í™” ë¶„ì„ ë°©ë²•ìœ¼ë¡œ ì•”í˜¸ë¥¼ ë¶„ì„í•˜ê¸° ì–´ë µê²Œ ë°©í•´í•˜ëŠ” ì„±ì§ˆë“¤
    - ë”°ë¼ì„œ ìƒì„±ëœ ê°’ì˜ ì—­ìƒê´€ê´€ê³„(decorrelation)ê°€ ì¤‘ìš”í•œ í•´ì‰¬ í•¨ìˆ˜ë‚˜ ì˜ì‚¬ ë‚œìˆ˜ ìƒì„±ê¸°ì˜ ì„¤ê³„ ë“±ì—ì„œ ì¤‘ìš”í•˜ê²Œ ìƒê°ë˜ì–´ì•¼ í•¨.
    - ë³µì¡ì„±ì€ ì˜ ì •ì˜ë˜ê³  ë°˜ë³µëœ ì¼ë ¨ì˜ substitionê³¼ permutationì„ í†µí•´ êµ¬í˜„ë¨
- Confusion (í˜¼ëˆ): ì•”í˜¸ë¬¸ê³¼ í‚¤ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ê°€ëŠ¥í•œ ë³µì¡í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ
    - ì•”í˜¸ë¬¸ì˜ ê° binary digit(bit)ì´ í‚¤ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì— ì˜ì¡´ì„±ì„ ê°€ì ¸ì•¼ í•¨. 
- Diffusion(í™•ì‚°): ì•”í˜¸ë¬¸ì— ëŒ€í•œ í‰ë¬¸ì˜ í†µê³„ì  êµ¬ì¡°ë¥¼ ì†Œë©¸ì‹œí‚¤ëŠ” ê²ƒ.
    - í‰ë¬¸ì˜ 1 bitë¥¼ ë°”ê¾¸ë©´ í†µê³„ì ìœ¼ë¡œ ì ˆë°˜ì˜ ì•”í˜¸ë¬¸ bitê°€ ë°”ë€Œì–´ì•¼ í•¨.
        - ì•”í˜¸ë¬¸ì˜ 1 bitë¥¼ ë°”ê¾¸ì–´ë„ í†µê³„ì ìœ¼ë¡œ ì ˆë°˜ì˜ í‰ë¬¸ bitë„ ë°”ë€Œì–´ì•¼ í•¨.
        - bitëŠ” ë‘ ê°€ì§€ ì„±ì§ˆë§Œ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ bitê°€ ì„ì˜ì˜ í•œ ìœ„ì¹˜ì—ì„œ ë‹¤ë¥¸ ìœ„ì¹˜ë¡œ ë°”ë€Œì—ˆì„ ë•Œ ì ˆë°˜ì˜ bitì˜ ìƒíƒœê°€ ë³€ê²½ë˜ì–´ì•¼ í•¨.
    - í‰ë¬¸ì„ í–‰ê³¼ ì—´ì— ë¶„ì‚°ì‹œì¼œ ì¤‘ë³µì„±ì„ ì¦ê°€ì‹œí‚´.


## 2. Hash

> í•´ì‹œ í•¨ìˆ˜(hash function)ëŠ” ì„ì˜ì˜ ê¸¸ì´ì˜ ë°ì´í„°ë¥¼ ê³ ì •ëœ ê¸¸ì´ì˜ ë°ì´í„°ë¡œ ë§¤í•‘í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. í•´ì‹œ í•¨ìˆ˜ì— ì˜í•´ ì–»ì–´ì§€ëŠ” ê°’ì€ í•´ì‹œ ê°’, í•´ì‹œ ì½”ë“œ, í•´ì‹œ ì²´í¬ì„¬ 
ë˜ëŠ” ê°„ë‹¨í•˜ê²Œ í•´ì‹œë¼ê³  í•œë‹¤. 

https://ko.wikipedia.org/wiki/%ED%95%B4%EC%8B%9C_%ED%95%A8%EC%88%98 ì— ë‚˜ì˜¨ í•´ì‹œ í•¨ìˆ˜ì— ëŒ€í•œ ì •ì˜ì´ë‹¤. 

ì •ì˜ì—ë„ ë‚˜ì™€ ìˆë“¯ì´ hashëŠ” ê¸¸ì´ê°€ ë‹¤ì–‘í•œ ë°ì´í„°ë¥¼ ê³ ì •ëœ ê¸¸ì´ì˜ ë°ì´í„°ë¡œ ë³€í™˜í•˜ëŠ”ë°, ê·¸ë ‡ë‹¤ë³´ë‹ˆ digestì˜ ê°œìˆ˜ë³´ë‹¤ keyê°’ì´ ë” ë§ì„ ìˆ˜ ë°–ì— ì—†ë‹¤. ì„œë¡œ ë‹¤ë¥¸ keyë¥¼ ê°€ì§€ê³  hashingí•´ë„ ê°™ì€ ê°’ì´ ë‚˜ì˜¤ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆë‹¤. ì´ë¥¼ Hash collisionì´ë¼ê³  ë¶€ë¥¸ë‹¤. ë‚˜ëŠ” Hash collisionì´ ì—†ëŠ” hash functionì€ ì—†ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³  ìˆë‹¤. ë””ë””í´ë ˆì˜ ì›ë¦¬(ë¹„ë‘˜ê¸°ì§‘ì˜ ì›ë¦¬)ê°€ ì´ë¥¼ ì¦ëª…í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.

ë˜í•œ hash functionì„ í†µí•´ ìƒì„±ëœ digestë¡œëŠ” ì›ë³¸ì„ êµ¬í• ìˆ˜ê°€ ì—†ì–´ì•¼ í•œë‹¤. ê·¸ë˜ì„œ hash function ìì²´ëŠ” ì•”í˜¸í™”ë¥¼ í•  ë•Œ ì´ìš©í•  ìˆ˜ ìˆì§€ë§Œ ì•”í˜¸í™”/ë³µí˜¸í™”ë¥¼ ê°™ì´ í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì–´ì§„ í•¨ìˆ˜ê°€ ì•„ë‹ˆë‹¤. 

Hash algorithmì˜ ì¢…ë¥˜ëŠ” ëŒ€í‘œì ìœ¼ë¡œ SHA(Secure Hash Algorithm), MD5 (Message Digest) ì •ë„ê°€ ìˆë‹¤. ì»¤ë°‹ì— ë¶™ì–´ìˆëŠ” í•´ì‰¬ë¼ë˜ê°€ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ë¦´ë¦¬ìŠ¤ ë  ë•Œ ë‚˜ì˜¤ëŠ” checksum ë“±ì—ì„œ ê·¸ ì˜ˆë¥¼ ì°¾ì•„ë³¼ ìˆ˜ ìˆë‹¤.


## 3. Hashì˜ ë‹¨ì  ë° ë³´ì™„

Hashì—ëŠ” ë„ë¦¬ ì•Œë ¤ì§„ ë‹¨ì ì´ ì¡´ì¬í•œë‹¤. Hash collisionì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— hash valueê°€ ì¤‘ë³µë˜ëŠ” ì…ë ¥ê°’ì„ ì°¾ê¸°ë§Œ í•˜ë©´ ì…ë ¥ê°’ì´ ê°™ë‹¤ê³  ì†ì¼ ìˆ˜ ìˆë‹¤. Birthday paradoxì™€ ì ‘ëª©ë˜ë©´ ì¼ë¶€ ì•Œê³ ë¦¬ì¦˜(ëŒ€í‘œì ìœ¼ë¡œ MD5)ì—ì„œëŠ” ì•„ì£¼ ë¹ ë¥¸ ì†ë„ë¡œ ì¤‘ë³µë˜ëŠ” hash valueë¥¼ ì°¾ì„ ìˆ˜ ìˆê²Œ ë˜ëŠ”ë°, ì´ë¥¼ `birthday attack`ì´ë¼ê³  í•œë‹¤. Hash functionìì²´ê°€ ì•„ì£¼ ë¹ ë¥¸ ì†ë„ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ê³µê²©ìë“¤ì´ ì•„ì£¼ ë¹ ë¥´ê²Œ ì„ì˜ì˜ ë¬¸ìì—´ì˜ digestì™€ ê³µê²©í•  ëŒ€ìƒì˜ digestë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤. 

ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ ì›ë¬¸ì— ì„ì´ì˜ ë¬¸ìì—´ì„ ë¶™ì—¬ì„œ hash functionì„ ê±°ì¹˜ë„ë¡ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ë¥¼ `salting`ì´ë¼ê³  í•˜ê³  ì´ ë•Œ ë¶™ì´ëŠ” ë¬¸ìì—´ì„ `salt`ë¼ê³  í•œë‹¤. ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ê³µê²©ìê°€ Digestë¥¼ ì•Œì•„ë‚´ë”ë¼ë„ saltì™€ í•¨ê»˜ í™•ì¸ì„ í•˜ê²Œ ë˜ë¯€ë¡œ ê³µê²©ìê°€ Saltê¹Œì§€ ì°¾ì•„ì•¼ í•´ì„œ ê³µê²© ë‚œì´ë„ê°€ ìƒìŠ¹í•œë‹¤. [Naver D2ì˜ ì•ˆì „í•œ íŒ¨ìŠ¤ì›Œë“œ ì €ì¥](https://d2.naver.com/helloworld/318732) ê¸€ì—ì„œëŠ” ëª¨ë“  íŒ¨ìŠ¤ì›Œë“œê°€ ê³ ìœ ì˜ saltë¥¼ ê°–ê³  saltì˜ ê¸¸ì´ê°€ 32ë°”ì´íŠ¸ ì´ìƒì´ì–´ì•¼ saltì™€ digestë¥¼ ì¶”ì¸¡í•˜ê¸°ê°€ ì–´ë µë‹¤ê³  ì–˜ê¸°í•˜ê³  ìˆë‹¤. 

Key stretchingì„ í†µí•´ì„œ hash functionì˜ ì†ë„ì™€ ê´€ë ¨ëœ ë‹¨ì ì„ ë³´ì™„í•  ìˆ˜ ìˆë‹¤. Hash functionì˜ ìˆ˜í–‰ì„ ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•˜ëŠ” ë°©ì‹ì´ë‹¤. ì›ë¬¸ì„ ê°€ì§€ê³  Hash functionì„ í†µí•´ Digestë¥¼ ë§Œë“¤ê³ , ìƒì„±ëœ digestë¥¼ ê°€ì§€ê³  ë˜ ë‹¤ì‹œ hash functionì„ ê±°ì³ digestë¥¼ ë§Œë“¤ê³ .. ì´ë¥¼ ë°˜ë³µí•˜ì—¬ í•˜ë‚˜ì˜ digestë¥¼ ìƒì„±í•  ë•Œ ì–´ëŠì •ë„ ì´ìƒì˜ ì‹œê°„ì´ ì†Œìš”ë˜ë„ë¡ ë§Œë“ ë‹¤. Rainbow tableì„ í™œìš©í•œ rainbow attackë° brute force attackìœ¼ë¡œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì¶”ì¸¡í•˜ê¸° í˜ë“¤ê²Œ ë§Œë“ ë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ [ìœ„ì—ì„œ ì–¸ê¸‰í•œ Naver D2ì˜ í¬ìŠ¤íŒ…](https://d2.naver.com/helloworld/318732) ì— ë”°ë¥´ë©´ Key stretchingì„ ì ìš©í•˜ë©´ ë™ì¼í•œ ì¥ë¹„ì—ì„œ ë¹„êµí•  ìˆ˜ ìˆëŠ” Digest ìˆ˜ë¥¼ ê²©ê°ì‹œì¼œì¤€ë‹¤ê³  í•œë‹¤. 

Adaptive key derivation functionì€ digest ìƒì„± ì‹œ saltingê³¼ key stretchingì„ ë°˜ë³µí•˜ê³  saltì™€ password ì™¸ì—ë„ ì…ë ¥ê°’ì„ ë” ë°›ì•„ì„œ ê³µê²©ìê°€ digestë¥¼ ìœ ì¶”í•˜ê¸° ë” í˜ë“¤ë„ë¡ í•˜ëŠ” ë°©ë²•ì´ë‹¤. PBKDF2, bcrypt, scryptë“±ì˜ ë°©ì‹ì´ ìˆë‹¤ê³  í•œë‹¤. ([ì°¸ê³ ](https://d2.naver.com/helloworld/318732)) [Javaì˜ PBEKeySpec](https://docs.oracle.com/javase/8/docs/api/javax/crypto/spec/PBEKeySpec.html)ë¥¼ ì‚¬ìš©í•˜ë©´ PBKDF2ë¥¼ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.


## 4. Symmetric-key algorithm

ì•”í˜¸í™”ì™€ ë³µí˜¸í™”ì— ê°™ì€ í‚¤ë¥¼ ì“°ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ Symmetric-key algorithm(ëŒ€ì¹­í‚¤ ì•Œê³ ë¦¬ì¦˜) ì´ë¼ê³  ë¶€ë¥¸ë‹¤. ê°™ì€ í‚¤ë¥¼ ê°€ì§€ê³  ì•”í˜¸í™”/ë³µí˜¸í™”ê°€ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— ì†¡ì‹ ìë¡œë¶€í„° í‚¤ë¥¼ ë°›ì§€ ëª»í•˜ë©´ ë³µí˜¸í™”ë¥¼ ì§„í–‰í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. 

í‚¤ì˜ í¬ê¸°ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì‘ê³ , ë¹„ëŒ€ì¹­í‚¤ì— ë¹„í•´ ì•”í˜¸í™”ì™€ ë³µí˜¸í™” ì†ë„ê°€ ë¹ ë¥´ë‹¤. ë‹¤ë§Œ í‚¤ êµí™˜ì‹œì˜ ë³´ì•ˆì´ ê³ ë ¤ë˜ì–´ì•¼ í•˜ë¯€ë¡œ í‚¤ê°€ êµí™˜ë˜ëŠ” ê³¼ì •ì—ì„œ SSLê°™ì€ ê³µê°œí‚¤ ì•”í˜¸ì— ê¸°ë°˜í•˜ê±°ë‚˜ Kerberosê°™ì´ ì¤‘ì•™ ê¸°ê´€ì„ í†µí•´ í‚¤ êµí™˜ì„ í•´ì•¼ í•œë‹¤. ë˜í•œ í‚¤ë¥¼ êµí™˜í•˜ëŠ” ì‹œìŠ¤í…œì´ ëŠ˜ ë•Œ ë§ˆë‹¤ ê³ ìœ í•œ í‚¤ê°€ ìƒì„±ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ê·¸ ìˆ˜ê°€ ë§ì„ ìˆ˜ë¡ í‚¤ì˜ ìˆ˜ë„ ì¦ê°€í•˜ë¯€ë¡œ í‚¤ ê´€ë¦¬ê°€ ì–´ë µë‹¤.

ëŒ€í‘œì ì¸ ëŒ€ì¹­í‚¤ ì•Œê³ ë¦¬ì¦˜ì—ëŠ” ê³¼ê±°ì˜ DES, í˜„ì¬ì˜ RC4ë‚˜ AESë“±ì´ ìˆë‹¤.


## 5. Public-key algorithm (asymmetric algorithm)

Public-key algorithm(ê³µê°œí‚¤ ì•Œê³ ë¦¬ì¦˜)ì€ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ëŒ€ì¹­í‚¤ ì•”í˜¸ì˜ í‚¤ ì „ë‹¬ì‹œì˜ ë‹¨ì ì„ ë³´ì™„í•˜ê³ ì ë§Œë“¤ì–´ì¡Œë‹¤. ì €ì¥ì†Œ ë“±ì— ê³µê°œëœ í‚¤ë¥¼ ìš”ì²­ìê°€ íšë“í•˜ê³  ìš”ì²­ìëŠ” íšë“í•œ ê³µê°œí‚¤ë¥¼ ë°”íƒ•ìœ¼ë¡œ í‰ë¬¸ì„ ì•”í˜¸í™”í•´ì„œ ìˆ˜ì‹ ìì—ê²Œ ì „ë‹¬í•œë‹¤. ìˆ˜ì‹ ìëŠ” ì „ë‹¬ë°›ì€ ì•”í˜¸ë¬¸ì„ ê°€ì§€ê³  ìˆëŠ” ê°œì¸í‚¤ë¡œ ë³µí˜¸í™”í•œë‹¤. ì„œëª…ì„ ì „ë‹¬í•  ë•ŒëŠ” ì´ ê³¼ì •ì„ ë°˜ëŒ€ë¡œ ìˆ˜í–‰í•œë‹¤. ê°œì¸í‚¤ë¡œ ì•”í˜¸í™”ë¥¼ í•˜ê³  ì „ë‹¬í•˜ë©´ ê³µê°œí‚¤ë¡œ ë³µí˜¸í™”ë¥¼ í•˜ëŠ” ë°©ì‹ì´ë‹¤. (ê³µê°œí‚¤ë¡œ ê°œì¸í‚¤ë¥¼ ë³µí˜¸í™” í•  ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤.)

í‚¤ê°€ ê³µê°œë˜ì–´ ìˆì–´ì„œ ë”°ë¡œ ë°°í¬í•  í•„ìš”ê°€ ì—†ë‹¤. ëŒ€ì²´ì ìœ¼ë¡œ bitìˆ˜ê°€ ë§ê³  ì•”í˜¸í™”/ë³µí˜¸í™”ì˜ ìˆ˜í–‰ì‹œê°„ì´ ê¸´ í¸ì´ë‹¤. ê·¸ë¦¬ê³  í‚¤ê°€ ê³µê°œë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ë”°ë¡œ ë°°í¬í•  í•„ìš”ê°€ ì—†ë‹¤.

ëŒ€í‘œì ìœ¼ë¡œ ì†Œì¸ìˆ˜ë¶„í•´(RSA), ì´ì‚°ëŒ€ìˆ˜(Diffie-Hellman), íƒ€ì›ê³¡ì„ (ECC) ë“±ì˜ ì•Œê³ ë¦¬ì¦˜ì´ ê³µê°œë˜ì–´ ìˆë‹¤.


## 6. Advanced Encryption Standard (AES)

ê³¼ê±°ì— DESê°€ ìˆì—ˆë‹¤. Data Encryption Standardë¼ê³ .. ì´ë¦„ë¶€í„° `ë°ì´í„° ì•”í˜¸í™” í‘œì¤€` ì´ê³  ê³¼ê±°ì—ëŠ” ê°•ë ¥í–ˆë‹¤ê³  í•œë‹¤. ë¸”ë¡ì˜ ë‹¨ìœ„ëŠ” 64ë¹„íŠ¸ì´ê³  í‚¤ ê¸¸ì´ë„ 64ë¹„íŠ¸ì´ì§€ë§Œ í‚¤ëŠ” íŒ¨ë¦¬í‹° ë¹„íŠ¸ë¥¼ ì œì™¸í•˜ë©´ 56ë¹„íŠ¸ì´ë‹¤. ê³¼ê±°ì˜ ì»´í“¨íŒ… ì„±ëŠ¥ì—ì„œëŠ” ì´ ê¸¸ì´ì˜ ì•”í˜¸ë¬¸ì€ ê°•ë ¥í–ˆê² ì§€ë§Œ í˜„ì¬ì˜ ì„±ëŠ¥ì„ ìƒê°í•˜ë©´ ì´ ê¸¸ì´ëŠ” ì§§ë‹¤. ì·¨ì•½ì  ë˜í•œ ë„ë¦¬ ì•Œë ¤ì ¸ìˆë‹¤. ì¼ë‹¨ ê¸¸ì´ë¥¼ ì–¸ê¸‰í–ˆë“¯ì´ ê¸¸ì´ê°€ ë„ˆë¬´ ì§§ì•„ì„œ Brute forceë¡œë„ êµ‰ì¥íˆ ë¹ ë¥¸ ì‹œê°„ ë‚´ì— plain textë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆìœ¼ë©°, ë¸”ë¡ ì•”í˜¸ë¥¼ ê³µê²©í•˜ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•ì¸ [linear cryptanalysis(ì„ í˜• ê³µê²©)](https://en.wikipedia.org/wiki/Linear_cryptanalysis)ì™€ [differntial cryptanalysis](https://en.wikipedia.org/wiki/Differential_cryptanalysis)([ì°¨ë¶„ ê³µê²©](http://www.secmem.org/blog/2019/04/08/%EC%B0%A8%EB%B6%84-%EA%B3%B5%EA%B2%A9%EC%9D%98-%EC%9D%B4%ED%95%B4/))ì— ì•½í•˜ë‹¤.

ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ triple DESê°™ì€ ì‘ìš©ë„ ë‚˜ì™”ë‹¤. DESë¥¼ ì„¸ë²ˆ ì ìš©í•˜ê³ (ì•”í˜¸í™”ë¥¼ ì„¸ë²ˆ í•œë‹¤ëŠ” ëœ»ì€ ì•„ë‹ˆë‹¤) í‚¤ì˜ ê¸¸ì´ê°€ ì„¸ ë°° ëŠ˜ì–´ë‚˜ì§€ë§Œ DESê°€ ê°–ëŠ” ì·¨ì•½ì ì„ ê·¸ëŒ€ë¡œ ê°€ì§„ë‹¤.

ì—¬íŠ¼ DESê°€ ì•ˆì „í•˜ì§€ ì•Šë‹¤ê³  ì¦ëª…ë˜ì–´ì„œ ìƒˆë¡œ ê³ ì•ˆëœ í‘œì¤€ì´ AESì´ë‹¤. 128bit Block cipherì´ë©°, ë‹¤ì–‘í•œ ê¸¸ì´(128, 192, 256 bit)ì˜ Keyë¥¼ ì§€ì›í•œë‹¤. ì´ ê¸€ì„ ì“°ë‹¤ê°€ ì™œ [512bit ê°™ì€ê±´ ì—†ëŠ”ì§€](https://ieeexplore.ieee.org/document/6122835) ê²€ìƒ‰í•´ ë´¤ëŠ”ë°, ë‚˜ë‘ ë¹„ìŠ·í•œ ê¸€ì„ ì½ê³  ë¹„ìŠ·í•œ ìƒê°ì„ í•œ ì‚¬ëŒì´ ìˆë˜ ëª¨ì–‘ì´ì–´ì„œ [í•¨ê»˜ ê³µìœ í•œë‹¤](https://crypto.stackexchange.com/questions/20253/why-we-cant-implement-aes-512-key-size). ê³µìœ í•œ ê¸€ì— ëŒ€í•œ ìš”ì•½ì€ í•˜ì§€ ì•Šê² ë‹¤.

AES ì•Œê³ ë¦¬ì¦˜ì€ ì•„ë˜ ì‚¬ì§„ì˜ ìˆœì„œëŒ€ë¡œ ì•”í˜¸í™”ì™€ ë³µí˜¸í™”ê°€ ì´ë£¨ì–´ì§„ë‹¤.

![aes-cycle](aes-cycle.png)

- **Add round key**: í•œ ì—´ì”© ë°ì´í„°ì™€ keyë¥¼ ë”í•˜ëŠ” ê³¼ì •ì´ë‹¤.
- **Sub bytes(Substitute byte)**: S-box tableì„ ì´ìš©í•´ì„œ byte ë‹¨ìœ„ í˜•íƒœë¡œ ë¸”ë¡ì„ êµí™˜í•˜ëŠ” ê³¼ì •ì´ë‹¤. Rijndael S-boxë¼ê³  ë¯¸ë¦¬ ì •ì˜ëœ í…Œì´ë¸”ì´ ì¡´ì¬í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ `0x9a`ì˜ ê²½ìš° `90`, `0a`ì˜ êµì°¨ì¸ b8ë¡œ ë³€í™˜ëœë‹¤.

![s-box-table](s-box.png)
> ì¶œì²˜: https://en.wikipedia.org/wiki/Rijndael_S-box


- **Shift row**: í–‰ ë‹¨ìœ„ë¡œ shift ì—°ì‚°ì„ í•œë‹¤. 
    - ì²« ë²ˆì§¸ í–‰ì€ shiftë˜ì§€ ì•ŠëŠ”ë‹¤.
    - ë‘ ë²ˆì§¸ í–‰ë¶€í„° ë„¤ ë²ˆì§¸ í–‰ê¹Œì§€ ê°ê° 1,2,3ìë¦¬ì”© ì™¼ìª½ìœ¼ë¡œ Shiftí•œë‹¤.
    - ì´ ë•Œ byteì•ˆì˜ bitëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  byteë¥¼ êµí™˜í•œë‹¤ (byte-exchange transformation)
- **Mix columns**: ì—´ ë‹¨ìœ„ë¡œ ê°ê°ì˜ ì—´ì„ ìƒìˆ˜ í–‰ë ¬ê³¼ ê³±í•´ì„œ ìƒˆë¡œìš´ ê°’ì„ ê°€ì§€ëŠ” ì—´ì„ ë°˜í™˜í•œë‹¤.

> ì°¸ê³ : í–‰ë ¬ ê³„ì‚°ì„ í•  ë•Œ ê³±ì—°ì‚°ì€ xtimeìœ¼ë¡œ, ë§ì…ˆì€ XORë¡œ ê³„ì‚°í•œë‹¤.

ê° roundë§ˆë‹¤ ì“°ì´ëŠ” round keyê°€ ìˆëŠ”ë°, ì´ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì„ **key schedule**ì´ë¼ê³  í•œë‹¤. Key scheduleì€ ì…ë ¥ëœ keyë¥¼ ë°”íƒ•ìœ¼ë¡œ í•˜ê³  ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ë‹¤.

- ì…ë ¥ëœ í‚¤ì˜ ë§ˆì§€ë§‰ 4ë°”ì´íŠ¸ë¥¼ ë½‘ì•„ í•œ ì¹¸ì”© shiftí•˜ê³  Sub byte ì—°ì‚°ì„ í•œë‹¤.
- ê·¸ í›„ round constant(Rcon)ê³¼ XORì—°ì‚°ì„ í•œë‹¤. 1 round ë§ˆë‹¤ í•˜ë‚˜ì”© ì•ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ì‚¬ìš©í•˜ë©° ê·¸ ë‹¤ìŒ keyì˜ ì²«ì§¸ ì—´ê³¼ XORí•œ ê²°ê³¼ê°€ ì²«ì§¸ round keyì˜ ì²«ì§¸ ì—´ì´ ëœë‹¤.


## 7. Javaì—ì„œì˜ AES

`javax.crypto` íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ë©´ ìœ„ì˜ ê³¼ì •ì„ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ì•”í˜¸í™”/ë³µí˜¸í™”ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤. IVì™€ KEYë¥¼ ì •í•˜ê³  `javax.crypto.Cipher` ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ìƒì„±í•œ cipher ê°ì²´ì— mode, key ivë¥¼ ì„¸íŒ…í•œ í›„ `cipher.doFinal()` ì„ í˜¸ì¶œí•˜ë©´ ëœë‹¤. ë³µí˜¸í™”ë„ ë§ˆì°¬ê°€ì§€ë¡œ ivì™€ keyê°€ ìˆë‹¤ë©´ cipher ê°ì²´ë¥¼ ë§Œë“¤ê³  mode, key, ivë¥¼ ì„¸íŒ…í•œ í›„ `cipher.doFinal()`ì„ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤. ì•„ë˜ì— ì˜ˆì‹œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ê¸°ë¥¼ ë°”ë€ë‹¤.

```java
public class CryptoUtil {
    final private String iv = "";
    final private String key = "";
    final private Key keySpec = new SecretKeySpec(key.getBytes(StandardCharsets.UTF_8), "AES");


    private CryptoUtil() {

    }


    public String encrypt(String originalString) throws NoSuchAlgorithmException, GeneralSecurityException, UnsupportedEncodingException {
        Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(iv.getBytes()));
        byte[] encrypted = cipher.doFinal(originalString.getBytes(StandardCharsets.UTF_8));
        return new String(Base64.encodeBase64(encrypted));
    }


    public String decrypt(String originalString) throws NoSuchAlgorithmException, GeneralSecurityException, UnsupportedEncodingException {
        Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        cipher.init(Cipher.DECRYPT_MODE, keySpec, new IvParameterSpec(iv.getBytes()));
        return new String(cipher.doFinal(Base64.decodeBase64(originalString.getBytes())), StandardCharsets.UTF_8);
    }
}
```


## 8. Pythonì—ì„œì˜ AES

Pythonì—ì„œëŠ” [PyCryptodome](https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html)ì—ì„œ AESë¥¼ ì§€ì›í•œë‹¤. documentì—ë„ ë‚˜ì™€ìˆëŠ” ìƒ˜í”Œì„ ì°¸ê³ í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ì•”í˜¸í™”/ë³µí˜¸í™”ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ Javaì—ì„œëŠ” paddingì´ ë³„ ë‹¤ë¥¸ ê³¼ì • ì—†ì–´ë„ `javax.crypto.Cipher` ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ì— ë§ì¶°ì„œ padding ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ëª…ì‹œë§Œ í•´ì£¼ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì˜ í•´ì¤¬ëŠ”ë°, pythonì€ í•œë‘ì¤„ ì •ë„ ë”°ë¡œ êµ¬í˜„ì´ ë˜ì–´ì•¼ í•œë‹¤ëŠ” ì°¨ì´ì ì€ ìˆë‹¤.

```python
from Crypto.Cipher import AES
import base64

block_size = 32
pad = lambda s: s + (block_size - len(s) % block_size) * chr(block_size - len(s) % block_size)
unpad = lambda s: s[0:ord(s[-1])]

key = "some_letters_with_32bit"
iv = "some_letters_with_16bit"

def encode(plaintext):
    cipher = AES.new(key, AES.MODE_CBC, IV=iv)
    return base64.b64encode(cipher.encrypt(pad(plaintext)))

def decode(ciphertext):
    cipher = AES.new(key, AES.MODE_CBC, IV=iv)
    return unpad(cipher.decrypt(base64.b64decode(ciphertext)))
```


## 8. ë§ˆì¹˜ë©°

Cryptographyì™€ AESì— ëŒ€í•´ ê²‰í•¥ê¸° ì‹ìœ¼ë¡œ ì•Œì•„ë³´ê³  Javaì™€ Pythonì—ì„œ ì´ë¥¼ ë¹ ë¥´ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ë‹¤. í˜„ì¬ì˜ ì—°ì‚° ì¥ë¹„ ì„±ëŠ¥ì´ ë„ˆë¬´ ì¢‹ì•„ì§„ ë‚˜ë¨¸ì§€ AES-128ë„ ì•ˆì „í•˜ì§€ ì•Šë‹¤ëŠ” ì–˜ê¸°ë¥¼ ë“¤ì–´ë³¸ ê²ƒ ê°™ì§€ë§Œ ê·¸ë˜ë„ ì—¬ì „íˆ AESì•Œê³ ë¦¬ì¦˜ì€ 128, 192, 256 ìƒê´€ì—†ì´ ê¶Œì¥ë˜ëŠ” ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ë‹¤ìˆ˜ì˜ ì–¸ì–´ë“¤ì—ì„œë„ ì´ë¥¼ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë„ë¡ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ì§€ì›ë˜ê³  ìˆë‹¤. ì´ ê¸€ì´ ì•”í˜¸í™”ì— ëŒ€í•œ ì¸ì‹ì„ ì œê³ í•˜ê³  ë‚˜ê°™ì´ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œ ì˜ ëª¨ë¥´ëŠ” ì‚¬ëŒë“¤ë„ ì‰½ê²Œ ì•”í˜¸í™”ë¥¼ í•˜ëŠ”ë° ë„ì›€ì´ ë˜ê¸¸ ë°”ë€ë‹¤.